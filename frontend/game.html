<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infinity AI RPG - Jogo</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Background Animation (Global) -->
    <div class="stars-wrapper">
        <div class="stars"></div>
        <div class="stars2"></div>
        <div class="stars3"></div>
    </div>

    <!-- App Sidebar (Context Menu) -->
    <aside id="app-sidebar" class="sidebar hidden">
        <div class="sidebar-header">
            <h2>üìú Menu</h2>
            <button id="close-sidebar" class="icon-btn">√ó</button>
        </div>
        <div class="sidebar-content">
            <button id="back-dashboard-btn" class="btn-primary full-width" style="margin-bottom: 15px;">‚¨Ö Voltar ao
                Menu</button>

            <!-- New Campaign Section -->
            <button id="sidebar-new-campaign-btn" class="btn-primary full-width"
                style="margin-bottom: 20px; background: linear-gradient(135deg, #ffd700, #ffa500); color: black; font-weight: bold;">+
                Nova
                Campanha</button>

            <h3
                style="font-size: 0.9rem; color: #aaa; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;">
                Minhas Campanhas</h3>
            <div id="sidebar-campaign-list" class="campaign-list" style="max-height: 300px; overflow-y: auto;">
                <!-- Campaigns loaded via JS -->
            </div>
        </div>
        <div class="sidebar-footer">
            <div id="user-profile-trigger" class="user-info-mini"
                style="cursor: pointer; padding: 10px; border-radius: 8px; transition: background 0.2s;">
                <span id="sidebar-username" style="font-weight: bold;">Usu√°rio</span>
                <small style="display: block; color: #aaa; font-size: 0.7rem;">Clique para perfil</small>
            </div>
            <button id="logout-btn" class="btn-cancel" style="margin-top: 10px; width: 100%;">Sair</button>
        </div>
    </aside>

    <main id="main-content">
        <div class="game-layout">
            <!-- Left Column: Chat -->
            <div class="chat-section">
                <header>
                    <div class="header-left">
                        <button id="menu-btn" class="icon-btn">‚ò∞</button>
                        <h1>‚ú¶ Infinity AI RPG</h1>
                    </div>
                    <div class="header-buttons">
                        <button id="reset-btn" class="icon-btn danger" title="Resetar Jogo">‚Ü∫</button>
                    </div>
                </header>

                <div id="messages" class="messages-area">
                    <!-- Messages will be loaded here -->
                </div>

                <div class="input-area">
                    <input type="text" id="user-input" placeholder="Digite sua a√ß√£o..." autocomplete="off">
                    <button id="send-btn">‚û§</button>
                </div>
            </div>

            <!-- Right Column: Inventory Sidebar -->
            <aside id="inventory-sidebar" class="inventory-sidebar">
                <!-- Stats Header -->
                <div class="sidebar-stats">
                    <div id="stats-display" class="stats-grid">
                        <!-- Populated by JavaScript -->
                    </div>
                    <div id="attributes-display" class="attributes-section">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <!-- Tab Navigation -->
                <div class="sidebar-tabs">
                    <button class="sidebar-tab active" data-tab="grimorio">üìú Grim√≥rio</button>
                    <button class="sidebar-tab" data-tab="equipment">‚öîÔ∏è Equipamentos</button>
                    <button class="sidebar-tab" data-tab="inventory">üéí Invent√°rio</button>
                </div>

                <!-- Tab Content -->
                <div class="sidebar-content">
                    <div id="tab-grimorio" class="tab-pane active">
                        <!-- Spells will be loaded here -->
                    </div>
                    <div id="tab-equipment" class="tab-pane hidden">
                        <!-- Equipment will be loaded here -->
                    </div>
                    <div id="tab-inventory" class="tab-pane hidden">
                        <!-- Items will be loaded here -->
                    </div>
                </div>

                <!-- Future Space -->
                <div class="sidebar-footer">
                    <small style="color: #666; text-align: center; display: block; padding: 10px;">
                        Espa√ßo reservado para futuras funcionalidades
                    </small>
                </div>
            </aside>
        </div>
    </main>

    <!-- Modals -->
    <div id="modal-overlay" class="modal-overlay hidden"></div>

    <!-- Creation Modal (Duplicated for availability in Game) -->
    <div id="creation-modal" class="modal hidden" style="max-width: 800px; width: 95%;">
        <div class="modal-header">
            <h2>‚ú® Criar Personagem</h2>
            <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body" style="padding: 0;">
            <!-- Tabs -->
            <div class="creation-tabs"
                style="display: flex; border-bottom: 1px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.2);">
                <button class="tab-btn active" data-tab="tab-basic"
                    style="flex: 1; padding: 15px; border: none; background: transparent; color: white; cursor: pointer; border-bottom: 2px solid var(--primary-color);">1.
                    B√°sico</button>
                <button class="tab-btn" data-tab="tab-story"
                    style="flex: 1; padding: 15px; border: none; background: transparent; color: #aaa; cursor: pointer;">2.
                    Passado / Hist√≥ria do personagem</button>
                <button class="tab-btn" data-tab="tab-attributes"
                    style="flex: 1; padding: 15px; border: none; background: transparent; color: #aaa; cursor: pointer;">3.
                    Atributos</button>
            </div>

            <form id="creation-form" style="padding: 20px;">
                <!-- Step 1: Basic Info -->
                <div id="tab-basic" class="tab-content">
                    <div class="row">
                        <div class="form-group half">
                            <label>Nome do Personagem</label>
                            <input type="text" id="char-name" required placeholder="Ex: Gandalf...">
                        </div>
                        <div class="form-group half">
                            <label>Ra√ßa</label>
                            <select id="char-race"
                                style="width: 100%; padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.05); color: white; border: 1px solid rgba(255,255,255,0.1);">
                                <option value="Humano">Humano (+1 em tudo)</option>
                                <option value="Elfo">Elfo (+2 Des, +1 Int)</option>
                                <option value="An√£o">An√£o (+2 Con, +1 For)</option>
                                <option value="Orc">Orc (+2 For, +1 Con)</option>
                                <option value="Draconato">Draconato (+2 For, +1 Car)</option>
                                <option value="Halfling">Halfling (+2 Des)</option>
                                <option value="Gnomo">Gnomo (+2 Int)</option>
                                <option value="Tiefling">Tiefling (+2 Car, +1 Int)</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group half">
                            <label>Classe</label>
                            <input type="text" id="char-class" required placeholder="Ex: Mago, Guerreiro...">
                        </div>
                        <div class="form-group half">
                            <label>Modo de Jogo</label>
                            <select id="char-mode-select"
                                style="width: 100%; padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.05); color: white; border: 1px solid rgba(255,255,255,0.1);">
                                <option value="narrativo">Narrativo</option>
                                <option value="rolagem de dados">Rolagem de Dados</option>
                                <option value="dnd5e">D&D 5E Rules</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Tema da Campanha</label>
                        <input type="text" id="char-theme" required
                            placeholder="Ex: Dark Fantasy, Cyberpunk, Medieval...">
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-primary next-tab" data-target="tab-story">Pr√≥ximo</button>
                    </div>
                </div>

                <!-- Step 2: Backstory -->
                <div id="tab-story" class="tab-content hidden">
                    <div class="form-group">
                        <label>Hist√≥ria & Descri√ß√£o</label>
                        <textarea id="char-backstory" required
                            placeholder="Descreva a apar√™ncia, personalidade e o passado do seu personagem..."
                            style="width: 100%; height: 200px; padding: 15px; border-radius: 8px; background: rgba(255,255,255,0.05); color: white; border: 1px solid rgba(255,255,255,0.1); resize: vertical;"></textarea>
                    </div>
                    <div class="modal-actions" style="justify-content: space-between;">
                        <button type="button" class="btn-cancel prev-tab" data-target="tab-basic">Voltar</button>
                        <button type="button" class="btn-primary next-tab" data-target="tab-attributes">Pr√≥ximo</button>
                    </div>
                </div>

                <!-- Step 3: Attributes -->
                <div id="tab-attributes" class="tab-content hidden">
                    <div class="attr-method-selector" style="margin-bottom: 20px; text-align: center;">
                        <label style="margin-right: 15px;">M√©todo de Distribui√ß√£o:</label>
                        <select id="attr-method"
                            style="padding: 5px 10px; border-radius: 5px; background: #333; color: white; border: 1px solid #555;">
                            <option value="pointBuy">Compra de Pontos (Point Buy)</option>
                            <option value="standardArray">Array Padr√£o (Standard Array)</option>
                        </select>
                    </div>

                    <div id="point-buy-container">
                        <div
                            style="text-align: center; margin-bottom: 15px; font-size: 1.1rem; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px;">
                            Pontos Restantes: <span id="points-remaining"
                                style="color: var(--premium-gold); font-weight: bold;">27</span> / 27
                        </div>
                        <div class="attributes-grid" id="pb-grid"
                            style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <!-- Generated via JS -->
                        </div>
                    </div>

                    <div id="standard-array-container" class="hidden">
                        <p style="text-align: center; color: #aaa; margin-bottom: 15px;">Distribua os valores: 15, 14,
                            13, 12, 10, 8</p>
                        <div class="attributes-grid" id="sa-grid"
                            style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <!-- Generated via JS -->
                        </div>
                    </div>

                    <div class="modal-actions" style="justify-content: space-between; margin-top: 20px;">
                        <button type="button" class="btn-cancel prev-tab" data-target="tab-story">Voltar</button>
                        <button type="submit" class="btn-primary">Iniciar Aventura</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Status Modal -->
    <div id="status-modal" class="modal hidden">
        <div class="modal-header">
            <h2>üéí Invent√°rio & Status</h2>
            <button class="close-modal">√ó</button>
        </div>
        <div class="modal-body" id="status-content">
            Carregando...
        </div>
    </div>

    <!-- Reset Modal -->
    <div id="reset-modal" class="modal hidden">
        <div class="modal-header">
            <h2>‚ö†Ô∏è Resetar Jogo?</h2>
            <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body">
            <p>Isso apagar√° TODO o seu progresso atual nesta campanha, invent√°rio e hist√≥rico. Tem certeza?</p>
            <div class="modal-actions">
                <button id="cancel-reset" class="btn-cancel">Cancelar</button>
                <button id="confirm-reset" class="btn-danger">Sim, Resetar</button>
            </div>
        </div>
    </div>

    <!-- User Profile Modal (Updated) -->
    <div id="user-modal" class="modal hidden">
        <div class="modal-header">
            <h2>üë§ Minha Conta</h2>
            <button class="close-modal">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label>Usu√°rio</label>
                <input type="text" id="profile-username" readonly style="opacity: 0.7; cursor: default;">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="text" id="profile-email" readonly style="opacity: 0.7; cursor: default;">
            </div>

            <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.1); margin: 20px 0;">

            <div class="form-group">
                <label>Alterar Senha</label>
                <button class="btn-primary full-width" style="margin-bottom: 10px;">Redefinir Senha</button>
            </div>
            <div class="form-group">
                <label>Assinatura</label>
                <button class="btn-primary full-width"
                    style="background: linear-gradient(135deg, #ffd700, #ffa500); color: black; font-weight: bold;">‚≠ê
                    Ver Planos</button>
            </div>

            <div class="modal-actions" style="justify-content: flex-end;">
                <button class="btn-cancel close-modal">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Delete Campaign Modal -->
    <div id="delete-modal" class="modal hidden">
        <div class="modal-header">
            <h2>üóëÔ∏è Excluir Campanha?</h2>
            <button class="close-modal">√ó</button>
        </div>
        <div class="modal-body">
            <p>Tem certeza que deseja apagar esta campanha para sempre? Esta a√ß√£o <strong>n√£o pode ser
                    desfeita</strong>.</p>
            <div class="modal-actions">
                <button id="cancel-delete" class="btn-cancel">Cancelar</button>
                <button id="confirm-delete" class="btn-danger">Excluir Permanentemente</button>
            </div>
        </div>
    </div>

    <script src="auth.js"></script>
    <script src="character_creation.js"></script>
    <script src="game.js"></script>
    <script src="sidebar_inventory.js"></script>
</body>

</html>